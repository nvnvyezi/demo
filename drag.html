<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Drag</title>
    <style>
      .out {
        position: relative;
        width: 400px;
        height: 400px;
        margin: 100px auto;
        border: 1px solid red;
      }
      .in {
        width: 100px;
        height: 100px;
        background-color: antiquewhite;
      }
    </style>
  </head>
  <body>
    <div class="out">
      <div class="in"></div>
    </div>
  </body>
  <script>
    const out = document.querySelector(".out");
    const inDiv = document.querySelector(".in");
    document.onmousedown = function(e) {
      let clientX = e.clientX - inDiv.offsetLeft;
      let clientY = e.clientY - inDiv.offsetTop;
      document.onmousemove = function(e) {
        let moveX = e.clientX - clientX;
        let moveY = e.clientY - clientY;
        if (moveX < 0) {
          moveX = 0;
        }
        if (moveY < 0) {
          moveY = 0;
        }
        if (moveX > out.offsetWidth - inDiv.offsetWidth) {
          moveX = out.offsetWidth - inDiv.offsetWidth - 2;
        }
        if (moveY > out.offsetHeight - inDiv.offsetHeight) {
          moveY = out.offsetHeight - inDiv.offsetHeight - 2;
        }
        inDiv.style.marginLeft = `${moveX}px`;
        inDiv.style.marginTop = `${moveY}px`;
      };
      document.onmouseup = function() {
        document.onmousemove = null;
        document.onmouseup = null;
      };
    };
  </script>
</html>
